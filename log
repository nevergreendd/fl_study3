Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'dacon', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean'}, 'dataset': {'num_workers': 4, 'valid_size': 0.1, 'test_size': 0.1, 'splitting': 'scaffold', 'task': 'regression', 'data_path': 'train_ori2.csv'}}
Running on: cuda:0
3495
3495
About to generate scaffolds
Generating scaffold 0/3495
Generating scaffold 1000/3495
Generating scaffold 2000/3495
Generating scaffold 3000/3495
About to sort in scaffold sets
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 2257.48095703125
0 50 1405.281005859375
Validation loss: 1332.6300538508463 RMSE: 36.505207
1 12 1119.376220703125
1 62 994.6283569335938
Validation loss: 1241.831270146848 RMSE: 35.239628
2 24 1180.764892578125
2 74 1128.819580078125
Validation loss: 1141.677588345328 RMSE: 33.78872
3 36 1050.27587890625
3 86 1094.165283203125
Validation loss: 1020.2944538805068 RMSE: 31.942049
4 48 1224.662353515625
Validation loss: 1046.9847985734912 RMSE: 32.357143
5 10 1150.6827392578125
5 60 1083.94287109375
Validation loss: 1009.0756916384984 RMSE: 31.765951
6 22 899.4210205078125
6 72 1264.213134765625
Validation loss: 985.0058824599301 RMSE: 31.384804
7 34 1110.4776611328125
7 84 851.3399658203125
Validation loss: 986.3744060877059 RMSE: 31.406599
8 46 1185.5823974609375
Validation loss: 961.0468022474928 RMSE: 31.000753
9 8 1127.912109375
9 58 1013.51220703125
Validation loss: 1085.0511369677874 RMSE: 32.940113
10 20 1227.181396484375
10 70 1335.579833984375
Validation loss: 1017.4348784613404 RMSE: 31.897255
11 32 1148.418701171875
11 82 1072.898193359375
Validation loss: 949.4052097790562 RMSE: 30.81242
12 44 931.37060546875
Validation loss: 1012.1965174633999 RMSE: 31.815035
13 6 1291.588134765625
13 56 931.7989501953125
Validation loss: 950.2487957361434 RMSE: 30.826105
14 18 748.9073486328125
14 68 933.9771728515625
Validation loss: 990.7282984167936 RMSE: 31.475838
15 30 1053.68017578125
15 80 694.4144287109375
Validation loss: 974.4881490363091 RMSE: 31.216791
16 42 1023.24267578125
Validation loss: 971.9695952232382 RMSE: 31.176426
17 4 875.4844970703125
17 54 1032.8001708984375
Validation loss: 1010.063550539208 RMSE: 31.781498
18 16 1207.9166259765625
18 66 1006.24072265625
Validation loss: 1015.7954902539622 RMSE: 31.871546
19 28 1118.117919921875
19 78 1370.373779296875
Validation loss: 1078.4940493345944 RMSE: 32.840435
20 40 795.92333984375
Validation loss: 1000.2137195838557 RMSE: 31.626156
21 2 889.3028564453125
21 52 987.673095703125
Validation loss: 1033.6886701611188 RMSE: 32.15103
22 14 1421.924560546875
22 64 1025.9278564453125
Validation loss: 1023.3596077730458 RMSE: 31.989992
23 26 1157.5924072265625
23 76 1045.087158203125
Validation loss: 981.6647099273595 RMSE: 31.33153
24 38 613.1278076171875
Validation loss: 1086.2286632286443 RMSE: 32.95798
25 0 1131.94091796875
25 50 1382.27197265625
Validation loss: 1083.7917176167398 RMSE: 32.920994
26 12 1030.260986328125
26 62 1228.19140625
Validation loss: 1010.1724617419749 RMSE: 31.78321
27 24 844.4306640625
27 74 1038.605712890625
Validation loss: 985.3396998189581 RMSE: 31.390121
28 36 965.9537353515625
28 86 773.0086059570312
Validation loss: 999.9380631323871 RMSE: 31.621798
29 48 959.5039672851562
Validation loss: 1010.4789315035146 RMSE: 31.78803
30 10 1051.204345703125
30 60 1263.3564453125
Validation loss: 997.7278933812007 RMSE: 31.586832
31 22 787.4564819335938
31 72 1018.5293579101562
Validation loss: 992.7058164929933 RMSE: 31.507233
32 34 1256.93310546875
32 84 711.8408203125
Validation loss: 988.0876583766118 RMSE: 31.43386
33 46 826.005859375
Validation loss: 1122.739478693309 RMSE: 33.507305
34 8 549.3165283203125
34 58 1285.8912353515625
Validation loss: 996.8437662643826 RMSE: 31.572834
35 20 965.2302856445312
35 70 918.2689208984375
Validation loss: 986.827445393647 RMSE: 31.41381
36 32 1247.1324462890625
36 82 871.6829833984375
Validation loss: 1025.4445377557531 RMSE: 32.022564
37 44 966.7431640625
Validation loss: 1027.1887633752685 RMSE: 32.049786
38 6 913.6435546875
38 56 1312.1414794921875
Validation loss: 996.7985351912272 RMSE: 31.572117
39 18 1068.2470703125
39 68 763.4322509765625
Validation loss: 994.38855767455 RMSE: 31.533928
40 30 1045.8203125
40 80 955.8560180664062
Validation loss: 1000.9160670414353 RMSE: 31.637257
41 42 988.9072265625
Validation loss: 1040.3421417498657 RMSE: 32.254337
42 4 624.9220581054688
42 54 1025.052490234375
Validation loss: 975.5710106442515 RMSE: 31.23413
43 16 994.7364501953125
43 66 1214.49658203125
Validation loss: 980.4961080906385 RMSE: 31.312876
44 28 680.6702880859375
44 78 1114.4700927734375
Validation loss: 1020.1624399092273 RMSE: 31.939983
45 40 516.4212646484375
Validation loss: 1031.046087663973 RMSE: 32.10991
46 2 979.8746948242188
46 52 774.0400390625
Validation loss: 1005.5957615368687 RMSE: 31.71113
47 14 827.420654296875
47 64 826.23681640625
Validation loss: 994.2067474102905 RMSE: 31.531044
48 26 636.5519409179688
48 76 717.7435302734375
Validation loss: 979.0500222454782 RMSE: 31.289776
49 38 637.5106811523438
Validation loss: 957.719346010924 RMSE: 30.94704
50 0 1241.199462890625
50 50 1156.8974609375
Validation loss: 1008.6106908410189 RMSE: 31.75863
51 12 891.8255615234375
51 62 969.2390747070312
Validation loss: 1015.7152706463221 RMSE: 31.870289
52 24 1111.65966796875
52 74 563.5092163085938
Validation loss: 986.2471602038189 RMSE: 31.404572
53 36 711.970703125
53 86 904.1056518554688
Validation loss: 994.9937072579021 RMSE: 31.543522
54 48 872.5687866210938
Validation loss: 973.4050417137693 RMSE: 31.19944
55 10 1094.697021484375
55 60 739.3173828125
Validation loss: 1007.26562709863 RMSE: 31.737448
56 22 862.03857421875
56 72 625.641845703125
Validation loss: 974.6973095213444 RMSE: 31.220142
57 34 899.812744140625
57 84 1147.732666015625
Validation loss: 986.8085195984062 RMSE: 31.41351
58 46 939.7411499023438
Validation loss: 981.4957611171427 RMSE: 31.328833
59 8 995.650390625
59 58 1120.7916259765625
Validation loss: 1009.5505916737553 RMSE: 31.773426
60 20 673.4637451171875
60 70 635.9918823242188
Validation loss: 995.4470798962437 RMSE: 31.550707
61 32 957.5865478515625
61 82 747.0546264648438
Validation loss: 975.3688303775295 RMSE: 31.230896
62 44 498.5315856933594
Validation loss: 1124.0312984433763 RMSE: 33.526577
63 6 810.5680541992188
63 56 761.2655029296875
Validation loss: 969.7959848311023 RMSE: 31.141548
64 18 808.826171875
64 68 690.4163208007812
Validation loss: 1061.3607747862195 RMSE: 32.578533
65 30 822.86669921875
65 80 577.4049072265625
Validation loss: 961.371133973742 RMSE: 31.005987
66 42 946.60302734375
Validation loss: 993.1283441669278 RMSE: 31.51394
67 4 1040.763671875
67 54 540.37890625
Validation loss: 1081.136656490643 RMSE: 32.880642
68 16 938.1968994140625
68 66 939.9921875
Validation loss: 970.0537674256245 RMSE: 31.145685
69 28 893.9986572265625
69 78 1203.831787109375
Validation loss: 1072.5353640143715 RMSE: 32.749588
70 40 668.5418701171875
Validation loss: 996.2933604942693 RMSE: 31.564117
71 2 804.124755859375
71 52 643.0
Validation loss: 976.291453189358 RMSE: 31.245665
72 14 839.8985595703125
72 64 694.04736328125
Validation loss: 984.6316579037205 RMSE: 31.378841
73 26 951.8834228515625
73 76 774.4117431640625
Validation loss: 1014.7667535382902 RMSE: 31.855404
74 38 920.256591796875
Validation loss: 1045.229043080677 RMSE: 32.33
75 0 730.38330078125
75 50 816.4424438476562
Validation loss: 1024.1905699459394 RMSE: 32.002975
76 12 904.2320556640625
76 62 1243.12548828125
Validation loss: 1044.4648014276281 RMSE: 32.31818
77 24 582.3721923828125
77 74 629.764404296875
Validation loss: 977.5417452487017 RMSE: 31.265663
78 36 1082.11962890625
78 86 1136.8621826171875
Validation loss: 1007.2026539450047 RMSE: 31.736458
79 48 1283.9267578125
Validation loss: 1022.0710342538391 RMSE: 31.969847
80 10 591.4992065429688
80 60 672.0369873046875
Validation loss: 965.2275887300771 RMSE: 31.068111
81 22 684.8578491210938
81 72 798.0701904296875
Validation loss: 1005.8143989103913 RMSE: 31.714579
82 34 578.9213256835938
82 84 1031.9796142578125
Validation loss: 1012.1423047784407 RMSE: 31.814186
83 46 824.5001220703125
Validation loss: 1014.027794955453 RMSE: 31.843803
84 8 1168.31640625
84 58 1083.653564453125
Validation loss: 1022.720263462012 RMSE: 31.979998
85 20 862.8387451171875
85 70 713.8330078125
Validation loss: 1024.4851165159384 RMSE: 32.00758
86 32 1124.201416015625
86 82 602.8385009765625
Validation loss: 1103.5133640759311 RMSE: 33.219173
87 44 668.7607421875
Validation loss: 1001.7554574873523 RMSE: 31.65052
88 6 734.7012939453125
88 56 1001.3497314453125
Validation loss: 1102.2723451630775 RMSE: 33.200485
89 18 1005.2967529296875
89 68 936.74462890625
Validation loss: 1071.3355709392908 RMSE: 32.731262
90 30 518.5830078125
90 80 514.318115234375
Validation loss: 1074.5489942665429 RMSE: 32.78031
91 42 593.9617919921875
Validation loss: 1084.501108776191 RMSE: 32.931763
92 4 624.40625
92 54 732.0755615234375
Validation loss: 1077.4013722591892 RMSE: 32.82379
93 16 992.24072265625
93 66 507.7674255371094
Validation loss: 1045.1190911323088 RMSE: 32.328304
94 28 463.35302734375
94 78 759.9608154296875
Validation loss: 1041.4730280572842 RMSE: 32.271862
95 40 865.9808349609375
Validation loss: 1061.3981433420263 RMSE: 32.579105
96 2 560.875732421875
96 52 774.8272705078125
Validation loss: 1095.1047034495882 RMSE: 33.092365
97 14 653.5220947265625
97 64 463.834716796875
Validation loss: 1077.4350984677203 RMSE: 32.824306
98 26 452.7192687988281
98 76 832.9282836914062
Validation loss: 1096.0236480625447 RMSE: 33.106247
99 38 444.2355651855469
Validation loss: 1065.1410852995164 RMSE: 32.6365
Loaded trained model with success.
Test loss: 998.1490883091518 Test RMSE: 31.593498
Running on: cuda:0
3495
3495
About to generate scaffolds
Generating scaffold 0/3495
Generating scaffold 1000/3495
Generating scaffold 2000/3495
Generating scaffold 3000/3495
About to sort in scaffold sets
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 5013.54541015625
0 50 1836.2962646484375
Validation loss: 1511.5600390065365 RMSE: 38.878788
1 12 1405.4287109375
1 62 1575.8211669921875
Validation loss: 1333.9402579496104 RMSE: 36.523148
2 24 1395.731201171875
2 74 1178.732421875
Validation loss: 1295.6347894094736 RMSE: 35.99493
3 36 1709.4952392578125
3 86 1150.0736083984375
Validation loss: 1268.0605007051397 RMSE: 35.609837
4 48 966.8245239257812
Validation loss: 1240.0283208371575 RMSE: 35.21404
5 10 882.062255859375
5 60 1441.613525390625
Validation loss: 1182.2522959012356 RMSE: 34.383896
6 22 1073.285400390625
6 72 1340.48486328125
Validation loss: 1224.978851755574 RMSE: 34.9997
7 34 1251.02490234375
7 84 1159.364501953125
Validation loss: 1182.6223802101988 RMSE: 34.38928
8 46 909.3971557617188
Validation loss: 1292.6427400692828 RMSE: 35.953342
9 8 875.0313720703125
9 58 1189.97265625
Validation loss: 1167.828538255227 RMSE: 34.173504
10 20 1102.314697265625
10 70 991.3378295898438
Validation loss: 1206.212351626858 RMSE: 34.730568
11 32 1131.283447265625
11 82 1136.5274658203125
Validation loss: 1184.6071577973898 RMSE: 34.418125
12 44 918.6588134765625
Validation loss: 1190.519673956841 RMSE: 34.503906
13 6 1086.9698486328125
13 56 932.642822265625
Validation loss: 1155.2973996575035 RMSE: 33.989666
14 18 928.4403076171875
14 68 1503.03564453125
Validation loss: 1135.4792665847735 RMSE: 33.696873
15 30 999.0133666992188
15 80 794.614501953125
Validation loss: 1256.0457966539443 RMSE: 35.440735
16 42 1084.805419921875
Validation loss: 1230.1119384765625 RMSE: 35.072952
17 4 927.1831665039062
17 54 907.078369140625
Validation loss: 1150.368549860651 RMSE: 33.917084
18 16 920.8798828125
18 66 1071.0064697265625
Validation loss: 1194.478346685284 RMSE: 34.561226
19 28 1144.8673095703125
19 78 864.7645263671875
Validation loss: 1174.5369365877955 RMSE: 34.27152
20 40 1170.885009765625
Validation loss: 1170.218060949812 RMSE: 34.20845
21 2 1186.7930908203125
21 52 716.41162109375
Validation loss: 1165.9742662489928 RMSE: 34.146366
22 14 1167.1943359375
22 64 1127.6011962890625
Validation loss: 1167.4607696095989 RMSE: 34.168125
23 26 1178.6329345703125
23 76 1016.1697998046875
Validation loss: 1253.6273707523728 RMSE: 35.4066
24 38 1088.79052734375
Validation loss: 1247.538224272195 RMSE: 35.320507
25 0 894.380126953125
25 50 974.321044921875
Validation loss: 1202.3510703712616 RMSE: 34.674934
26 12 1072.667724609375
26 62 892.2327880859375
Validation loss: 1203.9976089608704 RMSE: 34.69867
27 24 897.4330444335938
27 74 1262.9189453125
Validation loss: 1194.6098064433538 RMSE: 34.563126
28 36 905.0418701171875
28 86 735.656005859375
Validation loss: 1170.4531771159786 RMSE: 34.211887
29 48 1315.9736328125
Validation loss: 1176.0336795140133 RMSE: 34.293346
30 10 1176.25390625
30 60 871.3492431640625
Validation loss: 1258.155448673106 RMSE: 35.470486
31 22 1139.822265625
31 72 824.61279296875
Validation loss: 1230.4606727228465 RMSE: 35.077923
32 34 926.696533203125
32 84 730.8773193359375
Validation loss: 1257.8274593845138 RMSE: 35.465862
33 46 1182.074462890625
Validation loss: 1242.92858834253 RMSE: 35.25519
34 8 1027.109619140625
34 58 1052.690673828125
Validation loss: 1178.200995240307 RMSE: 34.324932
35 20 924.2196044921875
35 70 729.1141357421875
Validation loss: 1206.4610420817291 RMSE: 34.73415
36 32 728.2168579101562
36 82 878.6181640625
Validation loss: 1189.3649178316396 RMSE: 34.48717
37 44 972.0802001953125
Validation loss: 1184.1291808207602 RMSE: 34.41118
38 6 944.0734252929688
38 56 980.964599609375
Validation loss: 1202.1997241700617 RMSE: 34.672752
39 18 818.0029907226562
39 68 915.4776611328125
Validation loss: 1203.5296176156205 RMSE: 34.691925
40 30 704.658203125
40 80 932.794189453125
Validation loss: 1174.728988166525 RMSE: 34.27432
41 42 990.77294921875
Validation loss: 1277.8099735992344 RMSE: 35.746468
42 4 833.2113647460938
42 54 1262.1990966796875
Validation loss: 1165.1121077660503 RMSE: 34.13374
43 16 1065.437255859375
43 66 1034.10498046875
Validation loss: 1203.8098392869135 RMSE: 34.69596
44 28 804.6453247070312
44 78 778.5023193359375
Validation loss: 1196.3586918959304 RMSE: 34.588417
45 40 1160.2911376953125
Validation loss: 1233.7099299827073 RMSE: 35.124207
46 2 479.6195983886719
46 52 1044.001220703125
Validation loss: 1151.1490468022475 RMSE: 33.92859
47 14 1046.62109375
47 64 991.1675415039062
Validation loss: 1209.2740628917443 RMSE: 34.774616
48 26 734.806396484375
48 76 744.2991333007812
Validation loss: 1199.3761185697977 RMSE: 34.63201
49 38 1079.5224609375
Validation loss: 1222.4466286907907 RMSE: 34.963505
50 0 743.3298950195312
50 50 1368.544189453125
Validation loss: 1170.1824930185576 RMSE: 34.20793
51 12 753.7681274414062
51 62 1138.599853515625
Validation loss: 1170.0757444540204 RMSE: 34.206367
52 24 675.7174072265625
52 74 795.0526123046875
Validation loss: 1219.9885977933604 RMSE: 34.928333
53 36 1225.13720703125
53 86 734.0341796875
Validation loss: 1226.8948089687053 RMSE: 35.027058
54 48 1105.3017578125
Validation loss: 1188.459630053501 RMSE: 34.47404
55 10 867.7030639648438
55 60 702.9912719726562
Validation loss: 1219.650335710848 RMSE: 34.923492
56 22 810.766357421875
56 72 641.8526000976562
Validation loss: 1241.8613991286488 RMSE: 35.240055
57 34 857.5009765625
57 84 807.065185546875
Validation loss: 1177.2077970750695 RMSE: 34.310463
58 46 1023.509521484375
Validation loss: 1233.3216503766341 RMSE: 35.118683
59 8 895.9435424804688
59 58 1005.666015625
Validation loss: 1236.2204435944216 RMSE: 35.159924
60 20 810.171875
60 70 588.4970092773438
Validation loss: 1220.9406357030132 RMSE: 34.941963
61 32 957.24365234375
61 82 1173.6085205078125
Validation loss: 1272.3664505310933 RMSE: 35.670246
62 44 1291.9732666015625
Validation loss: 1168.4911462297412 RMSE: 34.183197
63 6 1163.501220703125
63 56 832.3941650390625
Validation loss: 1217.2810324420218 RMSE: 34.889557
64 18 701.7263793945312
64 68 667.667236328125
Validation loss: 1169.0368491448783 RMSE: 34.19118
65 30 791.6490478515625
65 80 1214.97021484375
Validation loss: 1195.1062844175322 RMSE: 34.57031
66 42 1247.751220703125
Validation loss: 1228.6176117730345 RMSE: 35.051643
67 4 869.6114501953125
67 54 974.1951904296875
Validation loss: 1181.7853713595764 RMSE: 34.377106
68 16 772.241943359375
68 66 871.625
Validation loss: 1169.2091123914308 RMSE: 34.1937
69 28 664.7816162109375
69 78 495.46270751953125
Validation loss: 1211.886921792454 RMSE: 34.812164
70 40 617.356689453125
Validation loss: 1168.1516484039219 RMSE: 34.178234
71 2 970.39697265625
71 52 875.918701171875
Validation loss: 1211.9635097208543 RMSE: 34.813267
72 14 1350.222900390625
72 64 837.0157470703125
Validation loss: 1268.4524579854271 RMSE: 35.61534
73 26 940.092529296875
73 76 922.3203125
Validation loss: 1236.690821781541 RMSE: 35.166615
74 38 1092.2169189453125
Validation loss: 1225.110526798106 RMSE: 35.00158
75 0 891.1398315429688
75 50 874.657470703125
Validation loss: 1296.9962948687098 RMSE: 36.013832
76 12 585.4034423828125
76 62 1045.611083984375
Validation loss: 1252.0035015641788 RMSE: 35.383663
77 24 1056.3414306640625
77 74 640.3007202148438
Validation loss: 1304.5757986686292 RMSE: 36.11891
78 36 1007.451416015625
78 86 860.281982421875
Validation loss: 1270.1971162724974 RMSE: 35.639824
79 48 966.7574462890625
Validation loss: 1257.7478205727302 RMSE: 35.46474
80 10 583.471923828125
80 60 661.333740234375
Validation loss: 1260.3301809578707 RMSE: 35.50113
81 22 959.544189453125
81 72 665.1146240234375
Validation loss: 1303.470782523169 RMSE: 36.10361
82 34 574.9344482421875
82 84 1121.8560791015625
Validation loss: 1250.412588212415 RMSE: 35.36117
83 46 872.615234375
Validation loss: 1239.3559941070469 RMSE: 35.204487
84 8 940.157470703125
84 58 952.5400390625
Validation loss: 1318.287380797815 RMSE: 36.308228
85 20 635.541015625
85 70 838.5118408203125
Validation loss: 1304.8928068756716 RMSE: 36.1233
86 32 802.378662109375
86 82 838.2012939453125
Validation loss: 1298.7444942441575 RMSE: 36.038097
87 44 1124.27783203125
Validation loss: 1295.2907718341467 RMSE: 35.990147
88 6 864.6629028320312
88 56 985.4150390625
Validation loss: 1236.5780074767192 RMSE: 35.165012
89 18 986.2059326171875
89 68 975.174072265625
Validation loss: 1322.532170599033 RMSE: 36.366634
90 30 785.9564208984375
90 80 1138.54931640625
Validation loss: 1242.3099410704692 RMSE: 35.246418
91 42 929.4850463867188
Validation loss: 1278.4116955951156 RMSE: 35.754883
92 4 949.9169311523438
92 54 675.9876708984375
Validation loss: 1247.984483778989 RMSE: 35.326824
93 16 576.3265380859375
93 66 969.625732421875
Validation loss: 1241.4772802314649 RMSE: 35.234604
94 28 977.509033203125
94 78 745.483642578125
Validation loss: 1261.0360817458363 RMSE: 35.51107
95 40 493.46234130859375
Validation loss: 1287.6839505171024 RMSE: 35.88431
96 2 819.4284057617188
96 52 606.2745361328125
Validation loss: 1352.3230172843168 RMSE: 36.773945
97 14 607.5668334960938
97 64 637.12255859375
Validation loss: 1297.1992096559366 RMSE: 36.01665
98 26 637.0474853515625
98 76 660.7835693359375
Validation loss: 1326.2231683157236 RMSE: 36.417347
99 38 574.0372314453125
Validation loss: 1283.6533269581616 RMSE: 35.82811
Loaded trained model with success.
Test loss: 1044.2872621372767 Test RMSE: 32.315434
